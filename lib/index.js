"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isNumber=exports.isMinusOrZero=exports.default=void 0;var errorObj=require("./constant"),isNumber=function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e+0-e==0},isMinusOrZero=(exports.isNumber=isNumber,function(e){return e<1});function RequestPool(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3;if(!isNumber(e))throw new Error(errorObj.nanError);if(isMinusOrZero(e))throw new Error(errorObj.naMinusOrZero);this.maxRequestNum=e,this.currentRequestNum=0,this.requestQueue=[],this.done=function(e){if("[object Function]"!==Object.prototype.toString.call(e))throw new Error(errorObj.doneCbError);t.doneCb=e},this.push=function(e){if(t.currentRequestNum<t.maxRequestNum){var r=e();if(!r instanceof Promise)throw new Error(errorObj.insError);t.currentRequestNum++,r.finally(function(){var e;t.currentRequestNum--,0!==t.requestQueue.length&&(e=t.requestQueue.pop(),t.push(e)),0===t.currentRequestNum&&t.doneCb&&t.doneCb()})}else t.requestQueue.unshift(e)}}exports.isMinusOrZero=isMinusOrZero;var _default=RequestPool;exports.default=_default;