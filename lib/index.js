"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isNumber=exports.isMinusOrZero=exports.default=void 0;var _constant=_interopRequireDefault(require("./constant"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var isNumber=function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e+0-e==0},isMinusOrZero=(exports.isNumber=isNumber,function(e){return e<1});function RequestPool(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3;if(!isNumber(e))throw new Error(_constant.default.nanError);if(isMinusOrZero(e))throw new Error(_constant.default.naMinusOrZero);this.maxRequestNum=e,this.currentRequestNum=0,this.requestQueue=[],this.done=function(e){if("[object Function]"!==Object.prototype.toString.call(e))throw new Error(_constant.default.doneCbError);r.doneCb=e},this.push=function(e){if(r.currentRequestNum<r.maxRequestNum){var t=e();if(!t instanceof Promise)throw new Error(_constant.default.insError);r.currentRequestNum++,t.finally(function(){var e;r.currentRequestNum--,0!==r.requestQueue.length&&(e=r.requestQueue.pop(),r.push(e)),0===r.currentRequestNum&&r.doneCb&&r.doneCb()})}else r.requestQueue.unshift(e)}}exports.isMinusOrZero=isMinusOrZero;var _default=RequestPool;exports.default=_default;